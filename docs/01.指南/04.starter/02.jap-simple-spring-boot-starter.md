---
title: jap-simple-spring-boot-starter æ¨¡å—ä½¿ç”¨å¸®åŠ©
permalink: /starter/jap-simple-spring-boot-starter/
sidebar: true
article: true
comment: true
categories:
- æŒ‡å—
- starter
  tags:
- jap-ids
- springboot
- starter
  date: 2021-10-12 14:05:06
---


# jap-simple-spring-boot-starter

ä¸º[JustAuth Plus](https://justauth.plus/) çš„ ***simple*** æˆæƒç­–ç•¥å¼€å‘çš„Spring Boot Starterä¾èµ–ã€‚

å¯è®¿é—®æœ¬starterçš„[demo](https://github.com/Vector6662/jap-spring-boot-starter-demo) ï¼ŒåŒ…å«è¾ƒä¸ºè¯¦å°½çš„è°ƒç”¨æµç¨‹å’Œç›¸å…³é…ç½®è¯´æ˜ã€‚

## å¼€æºä»“åº“åœ°å€ï¼š

[GitHub](https://github.com/fujieid/jap-spring-boot-starter)

[Gitee](https://gitee.com/fujieid/jap-spring-boot-starter-demo)

## å¿«é€Ÿå¼€å§‹

### å¼•å…¥ä¾èµ–

åœ¨ä½ é¡¹ç›®çš„ *pom.xml* æ–‡ä»¶ä¸­æ·»åŠ jap-simpleçš„starterçš„mavenä¾èµ–ï¼š

```xml
<dependency>
    <groupId>xyz.dong6662.jap.spring.boot</groupId>
    <artifactId>jap-simple-spring-boot-starter</artifactId>
    <version>1.0.0</version>
</dependency>
```

### application.propertiesä¸­é…ç½®

é¦–å…ˆåœ¨ *application.properties* æ–‡ä»¶ä¸­å®Œæˆä¸€äº›åŸºæœ¬é…ç½®ï¼Œè¿™äº›é…ç½®ä¿¡æ¯æ‰€æœ‰æˆæƒç­–ç•¥å‡ä¼šä½¿ç”¨åˆ°ï¼š

```properties
# åŸºç¡€é…ç½®
# å¦‚æœå¯å¯ç”¨äº†ssoï¼Œåˆ™éœ€è¦å¯¹ssoè¿›è¡Œä¸€äº›é…ç½®
jap.basic.sso=false
jap.basic.cache-expire-time=12
jap.basic.token-expire-time=12
# sso
jap.sso.cookie-domain=xxx
jap.sso.cookie-max-age=xxx
jap.sso.cookie-name=xxx
```

ç„¶åï¼Œä¸ºsimpleç­–ç•¥æ·»åŠ å®ƒçš„é…ç½®ä¿¡æ¯ï¼Œä½†å¤§å¤šæ•°æƒ…å†µä¸‹é‡‡ç”¨é»˜è®¤å³å¯ï¼š

```properties
# simpleç­–ç•¥
# é€šå¸¸æƒ…å†µé‡‡ç”¨é»˜è®¤é…ç½®
jap.simple.username-field=username
jap.simple.password-field=password
jap.simple.remember-me-field=rememberMe
jap.simple.remember-me-cookie-key=rememberMeCookieKey
# ...
```

### å®ç°JapUserServiceæ¥å£

ä¸[jap-simpleå®ç°JapUserServiceæ¥å£](https://justauth.plus/quickstart/jap-simple/#%E5%AE%9E%E7%8E%B0-japuserservice-%E6%8E%A5%E5%8F%A3)ä¸åŒçš„æ˜¯ï¼ŒğŸˆ**ä½ ä¸ä»…éœ€è¦ä¸ºè¯¥å®ç°ç±»æ·»åŠ `@Service`æ³¨è§£ï¼Œè¿˜éœ€è¦å¯¹è¯¥æ³¨è§£æ·»åŠ å‚æ•°`JapUserServiceType.SIMPLE`**ï¼Œè¡¨æ˜è¿™æ˜¯simpleç­–ç•¥çš„å®ç°ç±»ï¼š

```java
@Service(JapUserServiceType.SIMPLE)//Serviceæ³¨è§£å’Œå¿…è¦çš„å‚æ•°
public class SimpleUserServiceImpl implements JapUserService {
    /**
     * æ¨¡æ‹Ÿ DB æ“ä½œ
     */
    private static final List<JapUser> userDatas = new ArrayList<>();

    static {
        // æ¨¡æ‹Ÿæ•°æ®åº“ä¸­çš„æ•°æ®
        userDatas.add(new JapUser().setUsername("jap").setPassword("jap").setUserId("jap"));
        for (int i = 0; i < 10; i++) {
            userDatas.add(new JapUser().setUsername("jap" + i).setPassword("jap" + i).setUserId(UUID.fastUUID().toString()));
        }
    }

    @Override
    public JapUser getByName(String username) {
        return userDatas.stream()
                .filter((user) -> user.getUsername().equals(username))
                .findFirst()
                .orElse(null);
    }

    @Override
    public boolean validPassword(String password, JapUser user) {
        return user.getPassword().equals(password);
    }
}
```

å½“ç„¶ï¼Œä¹Ÿå¯ä»¥åœ¨ *application.properties* ä¸­æŒ‡å®šsimpleç­–ç•¥çš„`JapUserService`å®ç°ç±»ï¼Œå³æŒ‡å®šè¯¥serviceçš„åŒ…å…¨åï¼ˆbinary nameï¼‰ï¼š

```properties
jap.simple-user-service=xyz.dong6662.japspringbootstarterdemo.service.SimpleUserServiceImpl
```

### å®ç°Controller

```java
@RestController
@RequestMapping("/simple")
public class SimpleController {
    @Autowired
    SimpleStrategy simpleStrategy;
    @Autowired
    SimpleProperties simpleProperties;

    @RequestMapping(method = RequestMethod.GET, path = "/1")
    public JapResponse simple2(HttpServletRequest request, HttpServletResponse response){
        return simpleStrategy.authenticate(simpleProperties.getSimple(),request,response);
    }
}
```

## ä½¿ç”¨JapTemplate

è¿™æ˜¯ä¸ºäº†ç®€åŒ–å››ç§æˆæƒç­–ç•¥çš„è°ƒç”¨è€Œå¼€å‘çš„starterä¾èµ–ã€‚åªéœ€åœ¨å¼•å…¥äº†jap-simpleçš„mavenä¾èµ–çš„åŸºç¡€ä¸Šï¼Œå¼•å…¥ *JapTemplate*çš„ä¾èµ–ä¾¿å¯ä½¿ç”¨ï¼š

```xml
<dependency>
    <groupId>xyz.dong6662.jap.spring.boot</groupId>
    <artifactId>jap-spring-boot-starter-template</artifactId>
    <version>1.0.0</version>
</dependency>
```

è¿™æ ·ï¼Œåœ¨Controllerä¸­çš„æˆæƒä»£ç åªéœ€ä¸€è¡Œä¾¿å¯å®Œæˆæˆæƒï¼š

```java
@RestController
@RequestMapping("/simple")
public class SimpleController {
    @Autowired
    JapTemplate japTemplate;

    @RequestMapping(method = RequestMethod.GET, path = "/2")
    public JapResponse simple1() {
        return japTemplate.opsForSimple().authenticate();// è¿›è¡Œæˆæƒ
    }
}
```



